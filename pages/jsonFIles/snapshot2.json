[
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "AGREEMENT_ID",
        "Mapped to table": "STG_CSV_ACCOUNT",
        "Mapped to column": "SK_ACCOUNT_NO",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "AGREEMENT_NAME",
        "Mapped to table": "STG_CSV_ACCOUNT",
        "Mapped to column": "ACCOUNT_TITLE_1",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "AGREEMENT_OPEN_DTTM",
        "Mapped to table": "STG_CSV_ACCOUNT",
        "Mapped to column": "OPENING_DATE",
        "Transformation type": "SQL",
        "Transformation rule": "CAST(A.OPENING_DATE AS DATE FORMAT 'YYYYMMDD')"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "AGREEMENT_CLOSE_DTTM",
        "Mapped to table": "STG_CB_ACCOUNT_CLOSED",
        "Mapped to column": "ACCT_CLOSE_DATE",
        "Transformation type": "SQL",
        "Transformation rule": "CAST(ACCT_CLOSE_DATE AS DATE FORMAT 'YYYYMMDD')"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "AGREEMENT_PLANNED_EXPIRATION_DT",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "AGREEMENT_SUBTYPE_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 1
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "AGREEMENT_TYPE_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 1
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "BALANCE_SHEET_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_ACCOUNT",
        "Column name": "HOST_AGREEMENT_NUM",
        "Mapped to table": "STG_CSV_ACCOUNT",
        "Mapped to column": "ID",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "AGREEMENT_ID",
        "Mapped to table": "STG_CMS_CARD_REPORT",
        "Mapped to column": "SK_ACCOUNT_NUMBER",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "AGREEMENT_NAME",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "AGREEMENT_OPEN_DTTM",
        "Mapped to table": "STG_CMS_CARD_REPORT",
        "Mapped to column": "CONTRACT_START_DATE",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "AGREEMENT_CLOSE_DTTM",
        "Mapped to table": "STG_CMS_CARD_REPORT",
        "Mapped to column": "LAST_CARD_STATUS_CHANGE_DATE",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "AGREEMENT_PLANNED_EXPIRATION_DT",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "AGREEMENT_SUBTYPE_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 3
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "AGREEMENT_TYPE_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 3
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "BALANCE_SHEET_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_AGREEMENT_L0_CMS_CARD_REPORT",
        "Column name": "HOST_AGREEMENT_NUM",
        "Mapped to table": "STG_CMS_CARD_REPORT",
        "Mapped to column": "ACCOUNT_NUMBER",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CMS_CARDS_REPORT",
        "Column name": "INDIVIDUAL_PARTY_ID",
        "Mapped to table": "STG_CMS_CARDS",
        "Mapped to column": "SK_CUSTOMER_NUMBER",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CMS_CARDS_REPORT",
        "Column name": "BIRTH_DT",
        "Mapped to table": "STG_CMS_CARDS",
        "Mapped to column": null,
        "Transformation type": "SQL",
        "Transformation rule": "CAST(CASE WHEN SUBSTR(NATIONAL_ID,1,1)='2' THEN '19'||SUBSTR(NATIONAL_ID,2,6) ELSE '20'||SUBSTR(NATIONAL_ID,2,6) END AS DATE FORMAT 'YYYYMMDD')"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CMS_CARDS_REPORT",
        "Column name": "GENDER_TYPE_CD",
        "Mapped to table": "STG_CMS_CARDS",
        "Mapped to column": "BM_GENDER",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CMS_CARDS_REPORT",
        "Column name": "NATIONALITY_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": "EG'"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CMS_CARDS_REPORT",
        "Column name": "EMPLOYMENT_START_DTTM",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CMS_CARDS_REPORT",
        "Column name": "MARITAL_STATUS_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CMS_CARDS_REPORT",
        "Column name": "OTHER_NATIONALITY_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CUSTOMER",
        "Column name": "INDIVIDUAL_PARTY_ID",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "SK_CUSTOMER_CODE",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CUSTOMER",
        "Column name": "BIRTH_DT",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "DATE_OF_BIRTH",
        "Transformation type": "SQL",
        "Transformation rule": "CAST(DATE_OF_BIRTH AS DATE FORMAT 'YYYYMMDD')"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CUSTOMER",
        "Column name": "GENDER_TYPE_CD",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "BM_GENDER",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CUSTOMER",
        "Column name": "NATIONALITY_CD",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "NATIONALITY",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CUSTOMER",
        "Column name": "EMPLOYMENT_START_DTTM",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "EMPLOYMENT_START",
        "Transformation type": "SQL",
        "Transformation rule": "CAST(EMPLOYMENT_START AS TIMESTAMP(0) FORMAT 'YYYYMMDD')"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CUSTOMER",
        "Column name": "MARITAL_STATUS_CD",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "BM_MARITAL_STATUS",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_L0_CUSTOMER",
        "Column name": "OTHER_NATIONALITY_CD",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "OTHER_NATIONALITY",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "INDIVIDUAL_PARTY_ID",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "SK_CUSTOMER_CODE",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "NAME_TYPE_CD",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 1
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "INDIVIDUAL_NAME_START_DTTM",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "SQL",
        "Transformation rule": "MAX(CASE WHEN INDIVIDUAL_PARTY_ID IS NULL THEN CAST(CUSTOMER_SINCE AS TIMESTAMP(0) FORMAT 'YYYYMMDD') ELSE (DATE_TIME) END)"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "GIVEN_NAME",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "FAMILY_NAME",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "INDIVIDUAL_FULL_NAME_EN",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "SQL",
        "Transformation rule": "NAME_1"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "INDIVIDUAL_FULL_NAME_AR",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "SQL",
        "Transformation rule": "NAME_2"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_INDIVIDUAL_NAME_L0_CUSTOMER",
        "Column name": "INDIVIDUAL_NAME_END_DTTM",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CMS_CARDS",
        "Column name": "PARTY_ID",
        "Mapped to table": "STG_CMS_CARDS",
        "Mapped to column": "SK_CUSTOMER_NUMBER",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CMS_CARDS",
        "Column name": "PARTY_NUM",
        "Mapped to table": "STG_CMS_CARDS",
        "Mapped to column": "CUSTOMER_NUMBER",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CMS_CARDS",
        "Column name": "PARTY_START_DTTM",
        "Mapped to table": "STG_CMS_CARDS",
        "Mapped to column": null,
        "Transformation type": "SQL",
        "Transformation rule": "CAST(B.CONTRACT_START_DATE AS TIMESTAMP(0) FORMAT 'YYYY-MM-DD')"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CMS_CARDS",
        "Column name": "PARTY_TYPE_ID",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 4
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CMS_CARDS",
        "Column name": "PARTY_DESC",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": "Pre-Paid Customers'"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CMS_CARDS",
        "Column name": "PARTY_END_DTTM",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CMS_CARDS",
        "Column name": "INITIAL_DATA_SOURCE_TYPE_ID",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 2
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CUSTOMER",
        "Column name": "PARTY_ID",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "SK_CUSTOMER_CODE",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CUSTOMER",
        "Column name": "PARTY_NUM",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "ID",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CUSTOMER",
        "Column name": "PARTY_START_DTTM",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "CUSTOMER_SINCE",
        "Transformation type": "SQL",
        "Transformation rule": "CAST(CUSTOMER_SINCE AS VARCHAR(19))"
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CUSTOMER",
        "Column name": "PARTY_TYPE_ID",
        "Mapped to table": "STG_CB_CUSTOMER",
        "Mapped to column": "BM_PARTY_TYPE",
        "Transformation type": "COPY",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CUSTOMER",
        "Column name": "PARTY_DESC",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CUSTOMER",
        "Column name": "PARTY_END_DTTM",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": null
    },
    {
        "Layer": "CORE",
        "Mapping name": "L1_PARTY_L0_CUSTOMER",
        "Column name": "INITIAL_DATA_SOURCE_TYPE_ID",
        "Mapped to table": null,
        "Mapped to column": null,
        "Transformation type": "CONST",
        "Transformation rule": 1
    }
]